{"version":3,"sources":["link/client/HttpRepository.ts"],"names":[],"mappings":";;;;;;AAAA,mCAA2B,0BAA0B,CAAC,CAAA;AACtD,IAAY,CAAC,WAAM,GAAG,CAAC,CAAA;AAEvB;IAAyB,8BAAc;IAIrC,oBAAmB,QAAQ,EAAE,WAAW;QACtC,kBAAM,QAAQ,CAAC,CAAC;QAChB,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;IACjC,CAAC;IAES,4BAAO,GAAjB,UAAkB,IAAI;QACpB,IAAI,CAAC,UAAU,GAAG,UAAU,GAAG;YAC7B,GAAG,CAAC,gBAAgB,CAAE,eAAe,EAAE,SAAS,GAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACrE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACb,MAAM,CAAC,gBAAK,CAAC,OAAO,YAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEM,+BAAU,GAAjB,UAAkB,IAAI;QACpB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;YAClB,MAAM,EAAE,MAAM;YACd,IAAI,EAAE,IAAI;SACX,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI;YACpB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC;QACd,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAChB,CAAC;IAEM,+BAAU,GAAjB,UAAkB,YAAY;QAC5B,IAAI,QAAQ,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC;QACzB,IAAI,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,IAAI,EAAE,KAAK;YACzD,MAAM,CAAC,IAAI,CAAC,EAAE,KAAK,YAAY,CAAC,EAAE,GAAG,KAAK,GAAG,IAAI,CAAC;QACpD,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,KAAK;YACvB,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC;QACxB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC;YAC/C,QAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QACjC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,QAAQ,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;QACxC,CAAC;QAED,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC;IAC1B,CAAC;IAEM,6BAAQ,GAAf;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;YAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;YAClB,MAAM,EAAE,KAAK;SACd,CAAC,CAAC,IAAI,CAAC,UAAU,KAAK;YACrB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,MAAM,CAAC,KAAK,CAAA;QACd,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAChB,CAAC;IAEM,gCAAW,GAAlB,UAAmB,EAAE;QACnB,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,IAAI;YACjD,MAAM,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC;QACxB,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,4CAAuB,GAA9B,UAA+B,SAAiB;QAC9C,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,IAAI;YACjD,MAAM,CAAC,IAAI,CAAC,SAAS,KAAK,SAAS,CAAC;QACtC,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,mCAAc,GAArB,UAAsB,EAAE;QACtB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;YAClB,MAAM,EAAE,QAAQ;YAChB,GAAG,EAAE,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,EAAE;SAC9B,CAAC,CAAC,IAAI,CAAC;YACN,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,IAAI;gBAChD,MAAM,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC;YACxB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,KAAK;YAChC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,MAAM,CAAC,IAAI,CAAC;QACd,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAChB,CAAC;IAEM,kCAAa,GAApB,UAAqB,EAAE,EAAE,QAAQ;QAAjC,iBAaC;QAZC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;YAClB,MAAM,EAAE,KAAK;YACb,GAAG,EAAE,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,EAAE;YAC7B,IAAI,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE;SAC7B,CAAC,CAAC,IAAI,CAAC;YACN,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI;gBAC/B,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;oBACnB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBAC3B,CAAC;gBACD,MAAM,CAAC,IAAI,CAAC;YACd,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IACH,iBAAC;AAAD,CA9FA,AA8FC,CA9FwB,4BAAc,GA8FtC;AAED;kBAAe,UAAU,CAAC","file":"link/client/HttpRepository.js","sourcesContent":["import BaseRepository from '../../BaseHttpRepository';\nimport * as q from 'q';\n\nclass Repository extends BaseRepository {\n  private token_value;\n  private links: Array<any>;\n\n  public constructor(endpoint, token_value) {\n    super(endpoint);\n    this.token_value = token_value;\n  }\n\n  protected connect(opts) {\n    opts.beforeSend = function (xhr) {\n      xhr.setRequestHeader ('Authorization', 'Bearer '+this.token_value);\n    }.bind(this);\n    return super.connect(opts);\n  }\n\n  public createLink(link) {\n    return this.connect({\n      method: 'POST',\n      data: link\n    }).then(function (link) {\n      this.links.push(link);\n      return link;\n    }.bind(this));\n  }\n\n  public updateLink(updated_link) {\n    var deferred = q.defer();\n    var filtered_indexes = this.links.map(function (link, index) {\n      return link.id === updated_link.id ? index : null;\n    }).filter(function (index) {\n      return index !== null;\n    });\n    \n    if (filtered_indexes.length > 0) {\n      this.links[filtered_indexes[0]] = updated_link;\n      deferred.resolve(updated_link);\n    } else {\n      deferred.reject(new Error('No link'));\n    }\n\n    return deferred.promise;\n  }\n\n  public getLinks(): any {\n    if (this.links) return q(this.links);\n    return this.connect({\n      method: 'GET'\n    }).then(function (links) {\n      this.links = links;\n      return links\n    }.bind(this));\n  }\n\n  public getLinkById(id) {\n    return this.filterModels(this.links, function (link) {\n      return link.id === id;\n    });\n  }\n\n  public getCustomLinkByShortUrl(short_url: string) {\n    return this.filterModels(this.links, function (link) {\n      return link.short_url === short_url;\n    });\n  }\n\n  public deleteLinkById(id) {\n    return this.connect({\n      method: 'DELETE',\n      url: this.endpoint + '/' + id\n    }).then(function () {\n      return this.deleteModel(this.links, function (link) {\n        return link.id === id;\n      });\n    }.bind(this)).then(function (links) {\n      this.links = links;\n      return true;\n    }.bind(this));\n  }\n\n  public changeLongUrl(id, long_url) {\n    return this.connect({\n      method: 'PUT',\n      url: this.endpoint + '/' + id,\n      data: { long_url: long_url }\n    }).then(() => {\n      this.links = this.links.map((link) => {\n        if (link.id === id) {\n          link.long_url = long_url;\n        }\n        return link;\n      });\n    });\n  }\n}\n\nexport default Repository;"],"sourceRoot":"/source/"}