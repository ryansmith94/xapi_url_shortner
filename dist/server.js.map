{"version":3,"sources":["server.ts"],"names":[],"mappings":"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","file":"server.js","sourcesContent":["import * as express from 'express';\nimport * as knex from 'knex';\nimport * as bodyParser from 'body-parser';\nimport * as source_map_support from 'source-map-support';\nimport config from './config';\n\nsource_map_support.install({\n  handleUncaughtExceptions: false\n});\n\nvar app = express();\n\napp.use(express.static(__dirname));\napp.use('/node_modules', express.static(__dirname+'/../node_modules'));\napp.use('/example', express.static(__dirname+'/../example'));\napp.use(bodyParser.json()); // for parsing application/json\napp.use(bodyParser.urlencoded({ extended: true })); // for parsing application/x-www-form-urlencoded\n\n// Tracking.\nimport TrackingFactory from './tracking/Factory';\nvar tracking_service = TrackingFactory(config.lrs);\n\n// Token.\nimport TokenFactory from './token/server/Factory';\nimport TokenController from './token/server/ExpressController';\nvar token_service = TokenFactory(config.knex, 'token');\nvar token_controller = new TokenController(app, token_service);\n\n// Group.\nimport GroupFactory from './group/Factory';\nvar group_service = GroupFactory(config.knex, 'group');\n\n// User.\nimport UserFactory from './user/server/Factory';\nimport UserController from './user/server/ExpressController';\nvar user_service = UserFactory(config.knex, 'user');\nvar user_controller = new UserController(app, user_service, token_service);\n\n// Link.\nimport LinkFactory from './link/server/Factory';\nimport LinkController from './link/server/ExpressController';\nvar link_service = LinkFactory(config.knex, 'link');\nvar link_controller = new LinkController(app, link_service, token_service);\n\n// Injects services into services.\nuser_service.setGroupService(group_service);\ntoken_service.setUserService(user_service);\nlink_service.setTrackingService(tracking_service);\nlink_service.setUserService(user_service);\nlink_service.setGroupService(group_service);\ngroup_service.setUserService(user_service);\ngroup_service.setLinkService(link_service);\ntracking_service.setGroupService(group_service);\n\n// UI.\nimport * as React from 'react';\n\nvar dom = React.DOM;\napp.get('/', function (req, res) {\n  res.send(React.renderToStaticMarkup(dom.html({}, [\n    dom.head({}, [\n      dom.title({}, ['xAPI URL Shortener']),\n      dom.link({rel:'stylesheet', type:'text/css', href:'../node_modules/bootstrap/dist/css/bootstrap.min.css'}),\n      dom.link({rel:'stylesheet', type:'text/css', href:'./main.css'})\n    ]),\n    dom.body({}, [\n      dom.div({id:'app'}, []),\n      dom.script({src:'client.bundle.js'}),\n      dom.script({src:'/node_modules/jquery/dist/jquery.min.js'}),\n      dom.script({src:'/node_modules/bootstrap/dist/js/bootstrap.min.js'}),\n    ])\n  ])));\n});\n\nvar server = app.listen(config.port);\nconsole.log('App running at http://localhost:' + config.port);\n\nexport default app;"],"sourceRoot":"/source/"}