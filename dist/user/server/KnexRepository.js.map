{"version":3,"sources":["user/server/KnexRepository.ts"],"names":[],"mappings":"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","file":"user/server/KnexRepository.js","sourcesContent":["import BaseRepository from '../../BaseKnexRepository';\n\nclass Repository extends BaseRepository {\n\n  public constructor(config, collection) {\n    super(config, collection);\n  }\n\n  protected constructSchema(table) {\n    table.increments('id').primary();\n    table.string('email').notNullable();\n    table.string('password').notNullable();\n    table.integer('group_id').notNullable();\n    table.boolean('admin').notNullable();\n  }\n\n  public createUser(user) {\n    return this.connect().insert(user, 'id').then(function (ids) {\n      return {\n        id: ids[0],\n        email: user.email,\n        password: user.password,\n        group_id: user.group_id,\n        admin: user.admin\n      };\n    });\n  }\n\n  public getUserByEmail(email: string) {\n    return this.connect().where('email', email).first().then(function (user) {\n      if (!user) {\n        throw new Error('No user');\n      } else {\n        return user;\n      }\n    });\n  }\n\n  public getUserById(id) {\n    return this.connect().where('id', id).first().then(function (user) {\n      if (!user) {\n        throw new Error('No user');\n      } else {\n        return user;\n      }\n    });\n  }\n\n  public deleteUserById(id) {\n    return this.connect().where('id', id).delete().then(function (user) {\n      if (!user) {\n        throw new Error('No user');\n      } else {\n        return user;\n      }\n    });\n  }\n\n  public getUsersByGroupId(group_id) {\n    return this.connect().where('group_id', group_id);\n  }\n\n  public deleteUsersByGroupId(group_id) {\n    return this.connect().where('group_id', group_id).delete().then(function () {\n      return true;\n    });\n  }\n\n  public updateUserById(id, user) {\n    return this.connect().where('id', id).update(user).then((ids) => {\n      if (ids === 0) throw new Error('No user');\n      return user;\n    });\n  }\n}\n\nexport default Repository;"],"sourceRoot":"/source/"}